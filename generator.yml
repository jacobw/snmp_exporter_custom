---
auths:
  public_v1:
    version: 1
  public_v2:
    version: 2
  v3:
    version: 3
    username: ${SNMP_USERNAME}
    security_level: authPriv
    password: ${SNMP_PASSWORD}
    auth_protocol: SHA
    priv_protocol: AES
    priv_password: ${SNMP_PRIV_PASSWORD}

modules:
  # Default IF-MIB interfaces table with ifIndex.
  if_mib:
    walk: [sysUpTime, interfaces, ifXTable]
    lookups:
      - source_indexes: [ifIndex]
        lookup: ifAlias
      - source_indexes: [ifIndex]
        # Uis OID to avoid conflict with PaloAlto PAN-COMMON-MIB.
        lookup: 1.3.6.1.2.1.2.2.1.2 # ifDescr
      - source_indexes: [ifIndex]
        # Use OID to avoid conflict with Netscaler NS-ROOT-MIB.
        lookup: 1.3.6.1.2.1.31.1.1.1.1 # ifName
    overrides:
      ifAlias:
        ignore: true # Lookup metric
      ifDescr:
        ignore: true # Lookup metric
      ifName:
        ignore: true # Lookup metric
      ifType:
        type: EnumAsInfo

  # Trimmed down if_mib for slow JunOS devices.
  if_mib_junos:
    walk:
    - sysUpTime
    # ifXTable
    - ifHCInOctets
    - ifHCInUcastPkts
    - ifHCInBroadcastPkts
    - ifHCOutOctets
    - ifHCOutUcastPkts
    - ifHCOutBroadcastPkts
    lookups:
    - source_indexes: [ifIndex]
      lookup: ifName
      drop_source_indexes: true
    - source_indexes: [ifIndex]
      lookup: ifAlias
    overrides:
      ifAlias:
        ignore: true # Lookup metric
      ifName:
        ignore: true # Lookup metric
      

  # Trimmed down if_mib for slow JunOS devices.
  if_mib_junos_errors:
    walk:
    # ifTable
    - ifAdminStatus
    - ifOperStatus
    - ifInDiscards
    - ifInErrors
    - ifOutDiscards
    - ifOutErrors
    # ifXTable
    - ifHighSpeed
    lookups:
    - source_indexes:
      - ifIndex
      lookup: ifName
      drop_source_indexes: true
    - source_indexes:
      - ifIndex
      lookup: ifAlias
    overrides:
      ifAdminStatus:
        type: EnumAsStateSet
      ifAlias:
        ignore: true # Lookup metric
      ifName:
        ignore: true # Lookup metric
      ifOperStatus:
        type: EnumAsStateSet
      ifType:
        type: EnumAsInfo

  junos_ops:
    walk:
    - jnxOperatingCPU
    - jnxOperatingMemory
    - jnxOperatingBuffer
    - jnxYellowAlarmState
    - jnxRedAlarmState
    lookups:
    - source_indexes:
      - jnxOperatingContentsIndex
      - jnxOperatingL1Index
      - jnxOperatingL2Index
      - jnxOperatingL3Index
      lookup: jnxOperatingDescr
      drop_source_indexes: true
    overrides:
      jnxYellowAlarmState:
        type: EnumAsStateSet
      jnxRedAlarmState:
        type: EnumAsStateSet

  # Junos DOM
  junos_dom:
    walk:
      - jnxDomCurrentRxLaserPower
      - jnxDomCurrentTxLaserOutputPower
      - jnxDomCurrentWarnings
      - jnxDomCurrentAlarms
    lookups:
      - source_indexes:
        - ifIndex
        lookup: ifName
        drop_source_indexes: true
      - source_indexes:
        - ifIndex
        lookup: ifAlias
    overrides:
      jnxDomCurrentRxLaserPower:
        scale: .01
      jnxDomCurrentTxLaserOutputPower:
        scale: .01
      jnxDomCurrentAlarms:
        type: EnumAsStateSet
      ifName:
        ignore: true # Lookup metric

  # Thresholds don't change so ideally polled less/cached.
  junos_dom_thresholds:
    walk:
      - jnxDomCurrentRxLaserPowerHighAlarmThreshold
      - jnxDomCurrentRxLaserPowerLowAlarmThreshold
      - jnxDomCurrentRxLaserPowerHighWarningThreshold
      - jnxDomCurrentRxLaserPowerLowWarningThreshold
      - jnxDomCurrentTxLaserOutputPowerHighAlarmThreshold
      - jnxDomCurrentTxLaserOutputPowerLowAlarmThreshold
      - jnxDomCurrentTxLaserOutputPowerHighWarningThreshold
      - jnxDomCurrentTxLaserOutputPowerLowWarningThreshold
    lookups:
      - source_indexes:
        - ifIndex
        lookup: ifName
        drop_source_indexes: true
      - source_indexes:
        - ifIndex
        lookup: ifAlias
    overrides:
      jnxDomCurrentRxLaserPowerHighAlarmThreshold:
        scale: .01
      jnxDomCurrentRxLaserPowerLowAlarmThreshold:
        scale: .01
      jnxDomCurrentRxLaserPowerHighWarningThreshold:
        scale: .01
      jnxDomCurrentRxLaserPowerLowWarningThreshold:
        scale: .01
      jnxDomCurrentTxLaserOutputPowerHighAlarmThreshold:
        scale: .01
      jnxDomCurrentTxLaserOutputPowerLowAlarmThreshold:
        scale: .01
      jnxDomCurrentTxLaserOutputPowerHighWarningThreshold:
        scale: .01
      jnxDomCurrentTxLaserOutputPowerLowWarningThreshold:
        scale: .01

  junos_fru:
    walk:
    - jnxFruState
    lookups:
      - source_indexes:
        - jnxFruContentsIndex
        - jnxFruL1Index
        - jnxFruL2Index
        - jnxFruL3Index
        lookup: jnxFruName
        drop_source_indexes: true
    overrides:
      jnxFruState:
        type: EnumAsStateSet

